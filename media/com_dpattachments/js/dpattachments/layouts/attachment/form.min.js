function _readOnlyError(t){throw new TypeError('"'+t+'" is read-only')}!function(){"use strict";
/**
   * @package   DPAttachments
   * @copyright Copyright (C) 2018 Digital Peak GmbH. <https://www.digital-peak.com>
   * @license   http://www.gnu.org/licenses/gpl.html GNU/GPL
   */document.addEventListener("DOMContentLoaded",(function(){var t=function(t,e){e.length&&Array.prototype.forEach.call(e,(function(e){var a=t.closest(".com-dpattachments-layout-form"),n=a.querySelector(".dp-form__progress");n.style.display="block",n.value=0;var o=new XMLHttpRequest;o.open("post",a.getAttribute("data-upload-url"),!0),o.setRequestHeader("X-CSRF-Token",Joomla.getOptions("csrf.token","")),o.onreadystatechange=function(){if(4===o.readyState&&(n.style.display="none",200===o.status)){var e=JSON.parse(o.responseText);Joomla.renderMessages(e.messages);var a=document.querySelector('.com-dpattachments-layout-attachments__attachments[data-context="'+e.data.context+'"][data-item="'+e.data.item_id+'"]');a.parentElement.classList.remove("com-dpattachments-layout-attachments_empty"),a.innerHTML+=e.data.html,t.value=""}},o.upload.addEventListener("progress",(function(t){t.lengthComputable&&(n.value=Math.round(100*t.loaded/t.total))}),!1);var r=new FormData;r.append("file",e),r.append("attachment[context]",a.getAttribute("data-context")),r.append("attachment[item_id]",a.getAttribute("data-item")),o.send(r)}))};[].slice.call(document.querySelectorAll(".com-dpattachments-layout-form .dp-input__file")).forEach((function(e,a){e.addEventListener("change",(function(a){return t(e,e.files)}),!1),e.addEventListener("drop",(function(a){a.stopPropagation(),a.preventDefault(),t(e,a.dataTransfer.files)}),!1),0==a&&document.querySelector("body").addEventListener("paste",(function(a){for(var n=[],o=(a.clipboardData||{}).items||[],r=0;r<o.length;r++){var d=o[r].getAsFile();if(d){var s=new RegExp("/(.*)").exec(d.type);if(!d.name&&s){var i=s[1];d.name="clipboard"+r+"."+i}n.push(d)}}n.length&&(t(e,n),a.preventDefault(),a.stopPropagation())}),!1),[].slice.call(document.querySelectorAll(".com-dpattachments-layout-form")).forEach((function(e){e.addEventListener("dragenter",(function(t){t.stopPropagation(),t.preventDefault(),e.classList.add("com-dpattachments-layout-form_drag")}),!1),e.addEventListener("dragleave",(function(t){t.stopPropagation(),t.preventDefault(),e.classList.remove("com-dpattachments-layout-form_drag")}),!1),e.addEventListener("dragover",(function(t){t.stopPropagation(),t.preventDefault(),e.classList.add("com-dpattachments-layout-form_drag")}),!1),e.addEventListener("drop",(function(a){a.stopPropagation(),a.preventDefault(),e.classList.remove("com-dpattachments-layout-form_drag"),t(e.querySelector(".dp-input__file"),a.dataTransfer.files)}),!1),document.body.addEventListener("dragstart",(function(t){return _readOnlyError("initializedOnBody")}),!0),document.body.addEventListener("dragend",(function(t){return _readOnlyError("initializedOnBody")}),!0),document.body.addEventListener("drop",(function(t){t.dataTransfer.files&&t.dataTransfer.files.length&&(t.stopPropagation(),t.preventDefault())}),!1)}))}))}))}();